<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>PushWorld</title>

  <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Stylesheets -->
  <link rel="stylesheet" href="photon.min.css">
  <link rel="stylesheet" href="index.css">
  <link rel="stylesheet" href="puzzle_player.css">
</head>

<body>
<div id="header">
  <div class="content">
    <div class="title">PushWorld</div>
    <div class="subtitle">A benchmark for motion planning with tools and movable obstacles</div>
    <img class="banner" src="images/sample-puzzles.png" alt="Example PushWorld Puzzles"/>
  </div>
</div>
<div id="content">

<div class="section first-section">
  <div class="main-links">
    <a class="btn btn-large btn-default" href="https://arxiv.org/abs/8495.19481">
      <span class="icon icon-doc-text-inv icon-text"></span>
      Read Paper
    </a>
    <a class="btn btn-large btn-default" href="https://github.com/deepmind/pushworld">
      <span class="icon icon-github icon-text"></span>
      View Github
    </a>
    <a class="btn btn-large btn-default" style="margin-right: 0px;" href="mailto:pushworld@deepmind.com">
      <span class="icon icon-mail icon-text"></span>
      Contact Us
    </a>
  </div>
</div>

<div class="section first-section">
  <span class="text">
  PushWorld is a novel grid-world environment designed to test planning and reasoning
  with physical tools and movable obstacles. While recent advances in artificial intelligence have achieved human-level performance in environments like Starcraft and Go, many physical reasoning tasks remain challenging for computers. The PushWorld benchmark contains a collection of puzzles that emphasize this challenge while minimizing the complexity of physics.</span>

  <span class="text">PushWorld is available as an OpenAI Gym environment and in PDDL format in <a href="https://www.deepmind.com/">Github</a>. The environment is suitable for research in classical planning, reinforcement learning, combined task and motion planning, and cognitive science.</span>
</div>

<div class="section">
  <div class="title">Play PushWorld</div>
  Here you can play all puzzles in the PushWorld benchmark.

  <div class="pushworld_puzzles">
    <div class="select_puzzle_group panel">
      <div class="toolbar toolbar-header title-toolbar">
        <div class="title vcenter">Select a Puzzle Difficulty</div>
      </div>
      <div class="select-difficulty">
        <div style="text-align: center;">
          <div><div style="font-size:20px; padding:10px 20px;" class="btn btn-form btn-large btn-primary" puzzle_group="level1">Level 1</div></div>
          <div style="margin-top:20px;"><div style="font-size:20px; padding:10px 20px;" class="btn btn-form btn-large btn-primary" puzzle_group="level2">Level 2</div></div>
          <div style="margin-top:20px;"><div style="font-size:20px; padding:10px 20px;" class="btn btn-form btn-large btn-primary" puzzle_group="level3">Level 3</div></div>
          <div style="margin-top:20px;"><div style="font-size:20px; padding:10px 20px;" class="btn btn-form btn-large btn-primary" puzzle_group="level4">Level 4</div></div>
        </div>
      </div>
    </div>

    <div id="pw-preview-template" class="pushworld_preview">
      <img src="images/loading.gif" class="pw-puzzle-loading" alt="Loading" width="25px" height="25px"/>
      <canvas class="vcenter" height="138px" width="138px"></canvas>
    </div>

    <div class="preview_panel panel" puzzle_group="level1" style="display:none;">

      <div class="toolbar toolbar-header title-toolbar">
        <div class="title puzzle_title vcenter">Level 1 Puzzles</div>
      </div>
      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="return_select_puzzle_group btn btn-large btn-default">
              <span class="icon icon-left icon-text"></span>
              Select Difficulty
            </button>
          </div>
        </div>
      </div>

      <div class="preview_list">
        <div class="previews"></div>
      </div>
    </div>

    <div class="preview_panel panel" puzzle_group="level2" style="display:none;">

      <div class="toolbar toolbar-header title-toolbar">
        <div class="title puzzle_title vcenter">Level 2 Puzzles</div>
      </div>
      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="return_select_puzzle_group btn btn-large btn-default">
              <span class="icon icon-left icon-text"></span>
              Select Difficulty
            </button>
          </div>
        </div>
      </div>

      <div class="preview_list">
        <div class="previews"></div>
      </div>
    </div>

    <div class="preview_panel panel" puzzle_group="level3" style="display:none;">

      <div class="toolbar toolbar-header title-toolbar">
        <div class="title puzzle_title vcenter">Level 3 Puzzles</div>
      </div>
      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="return_select_puzzle_group btn btn-large btn-default">
              <span class="icon icon-left icon-text"></span>
              Select Difficulty
            </button>
          </div>
        </div>
      </div>

      <div class="preview_list">
        <div class="previews"></div>
      </div>
    </div>

    <div class="preview_panel panel" puzzle_group="level4" style="display:none;">

      <div class="toolbar toolbar-header title-toolbar">
        <div class="title puzzle_title vcenter">Level 4 Puzzles</div>
      </div>
      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="return_select_puzzle_group btn btn-large btn-default">
              <span class="icon icon-left icon-text"></span>
              Select Difficulty
            </button>
          </div>
        </div>
      </div>

      <div class="preview_list">
        <div class="previews"></div>
      </div>
    </div>

    <div class="puzzle_panel panel">
      <div class="toolbar toolbar-header title-toolbar">
        <div class="title puzzle_title vcenter">Puzzle Name</div>
      </div>
      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="all_puzzles btn btn-large btn-default">
              <span class="icon icon-layout icon-text"></span>
              Puzzle List
            </button>
          </div>
          <div class="right-buttons">
            <button class="reset_button btn btn-large btn-default pull-right">
              <span class="icon icon-to-start icon-text"></span>
              Reset
            </button>

            <button class="undo_button btn btn-large btn-default pull-right">
              <span class="icon icon-left icon-text"></span>
              Undo
            </button>
          </div>
        </div>
      </div>

      <div class="puzzle">
        <div id="instructions_modal" class="modal" style="display:block;">
          <div class="modal-content">
            <div class="arrow-keys">
              <div class="key hidden"></div>
              <div class="key"><span class="icon icon-up-bold"></span></div>
              <div class="key hidden"></div>
              <div class="key"><span class="icon icon-left-bold"></span></div>
              <div class="key"><span class="icon icon-down-bold"></span></div>
              <div class="key"><span class="icon icon-right-bold"></span></div>
            </div>
            <div class="text">Use the arrow keys to push the <a>red shapes</a> into their outlines. Use the
              <span class="icon icon-left icon-text" style="margin: 0px 5px;"></span><b>Undo</b>
            and
            <span class="icon icon-to-start icon-text" style="margin: 0px 5px;"></span><b>Reset</b>
            buttons above to retry a puzzle.
            </div>
            <button type="submit" class="btn btn-form btn-large btn-primary">OK, got it!</button>
          </div>
        </div>

        <div id="solved_modal" class="modal">
          <div class="modal-content">
            Solved!
          </div>
        </div>

        <canvas id="play_canvas"></canvas>

        <div id="touch-keypad-container">
          <div id="touch-keypad" class="arrow-keys">
            <div class="key left"><span class="icon icon-left-bold"></span></div>
            <div class="up-down-group">
              <div class="key up"><span class="icon icon-up-bold"></span></div>
              <div class="key down"><span class="icon icon-down-bold"></span></div>
            </div>
            <div class="key right"><span class="icon icon-right-bold"></span></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="section">
  <div class="title">PushWorld vs. Related Environments</div>

  <span class="text">Solving PushWorld puzzles requires many skills, including:</span>

  <ul>
    <li>
      <b>Path Planning</b>: Finding a collision-free path to move an object from one position to another, considering walls and object shapes.
    </li>
    <li>
      <b>Manipulation Planning</b>: Exploring alternative ways to push an object along a desired path. Some puzzles require the agent to preemptively position itself so that it can move from pushing in one direction to pushing in a different direction in the future.
    </li>
    <li>
      <b>Moving Obstacles</b>: The agent must decide between finding a path around an obstacle or moving the obstacle out of the way. Some obstacles introduce choices in which freeing one path blocks another, and choices can be irreversible. Obstacles can also be "parasitic": once pushed against an object, the agent can never separate the obstacle from the object.
    </li>
    <li>
      <b>Using Tools</b>: Sometimes to move an object into a desired position, the agent must use one or more objects as tools to indirectly push the target object: the agent pushes a tool object, which simultaneously pushes the target or another tool. In some puzzles the agent must assemble a tool by pushing multiple objects together.
    </li>
    <li>
      <b>Prioritizing Multiple Goals</b>: Sometimes moving an object into its goal position may prevent achieving another goal. Puzzles may also require achieving multiple goals simultaneously by preemptively arranging objects and pushing them all at once.
    </li>
  </ul>

  <span class="text">Several existing environments have dynamics similar to PushWorld: <a href="https://en.wikipedia.org/wiki/Sokoban">Sokoban</a>, <a href="https://en.wikipedia.org/wiki/Sliding_puzzle">sliding block puzzles</a>, and grid-based path planning. However, none of these environments require all of the skills above.</span>

  <table class="related-table">
    <colgroup>
      <col span="1" style="width: 27%;">
      <col span="1" style="width: 18.25%;">
      <col span="1" style="width: 18.25%;">
      <col span="1" style="width: 18.25%;">
      <col span="1" style="width: 18.25%;">
    </colgroup>
    <tbody>
      <tr class="top-row">
        <td></td>
        <td>Sokoban</td>
        <td>Sliding Block Puzzles</td>
        <td>Grid-Based Path Planning</td>
        <td>PushWorld</td>
      </tr>
      <tr>
        <td>Varied Object Shapes</td>
        <td class="no">X</td>
        <td class="yes">&#10004;</td>
        <td class="yes">&#10004;</td>
        <td class="yes">&#10004;</td>
      </tr>
      <tr>
        <td>Path Planning</td>
        <td class="yes">&#10004;</td>
        <td class="no">X</td>
        <td class="yes">&#10004;</td>
        <td class="yes">&#10004;</td>
      </tr>
      <tr>
        <td>Manipulation Planning</td>
        <td class="no">X</td>
        <td class="no">X</td>
        <td class="no">X</td>
        <td class="yes">&#10004;</td>
      </tr>
      <tr>
        <td>Movable Obstacles</td>
        <td class="yes">&#10004;</td>
        <td class="yes">&#10004;</td>
        <td class="no">X</td>
        <td class="yes">&#10004;</td>
      </tr>
      <tr>
        <td>Tool Use</td>
        <td class="no">X</td>
        <td class="no">X</td>
        <td class="no">X</td>
        <td class="yes">&#10004;</td>
      </tr>
      <tr>
        <td>Multiple Goals</td>
        <td class="yes">&#10004;</td>
        <td class="yes">&#10004;</td>
        <td class="no">X</td>
        <td class="yes">&#10004;</td>
      </tr>
    </tbody>
  </table>
</div>

<div class="section">
  <div class="title">Evaluation: Classical Planners</div>
  <span class="text">We compared the following classical planning algorithms on the set of puzzles above:</span>
  <ul>
    <li><span><b>Fast Forward</b> is a seminal planning algorithm that relies on a delete relaxation heuristic.</span></li>

    <li><span><b>Fast  Downward</b>  introduced domain transition graphs and the causal graph heuristic (winner of IPC 2004 classical track).</span></li>

    <li><span><b>LAMA</b> introduced the landmark heuristic (winner of IPC 2008 sequential satisficing track).</span></li>

    <li><span><b>Best-First Width Search (BFWS)</b> introduced the novelty heuristic, which prioritizes exploring states with novel combinations of variable values (winner of IPC 2018  agile track).</span></li>

    <li><span><b>Fast Downward Stone Soup (FDSS)</b> is a portfolio of planners (winner of IPC 2018 satisficing track).</span></li>

    <li><span><b>Saarplan</b> is another portfolio of planners (runner-up of IPC 2018 agile track).</span></li>

    <li><span><b>RGD</b> is a greedy best-first search with the recursive graph distance heuristic introduced in the <a href="https://arxiv.org/abs/8495.19481">PushWorld paper</a>.</span></li>

    <li><span><b>Novelty+RGD</b> is a greedy best-first search with a lexicographic heuristic that combines the novelty heuristic with the RGD heuristic, prioritizing novelty.</span></li>
  </ul>

  The plot below shows how many puzzles each planner solves within a given time per puzzle. Novelty+RGD solves the most puzzles (69.1%) within 30 minutes per puzzle, followed by FDSS (61.4%). Notably, Novelty+RGD solves as many puzzles in 52 seconds as FDSS solves in 30 minutes.

  <img class="classical-results-large" src="images/classical-planner-results-large.png" alt="Classical Planning Results" width="100%"/>
  <img class="classical-results-medium" src="images/classical-planner-results-medium.png" alt="Classical Planning Results" width="100%"/>
  <img class="classical-results-small" src="images/classical-planner-results-small.png" alt="Classical Planning Results" width="100%"/>
</div>

<div class="section">
  <div class="title">Evaluation: Model-Free Deep Reinforcement Learning</div>

  <span class="text">We selected two deep reinforcement learning (RL) algorithms to evaluate on PushWorld: <b>Deep Q-Network</b> (DQN), an off-policy, value-based algorithm, and <b>Proximal Policy Optimization</b> (PPO), an on-policy, policy-gradient algorithm. We chose these algorithms because they are widely used, easy to implement, and have shown competitive performance on diverse and challenging tasks like Atari and continuous robotic control.</span>

  <span class="text">We trained both algorithms on the Level 1 puzzles above for 500 million steps and measured the percentage of Level 1 puzzles they could solve. The final performance of both algorithms was equal to their performance at the start of training. We believe this is due to the low probability of solving most Level 1 puzzles with the initial random policy, resulting in sparse positive rewards and therefore insufficient signal for training.</span>

  <span class="text">To address the sparse reward problem, we programmatically generated a collection of Level 0 puzzle sets that are no larger than 10x10 cells. The <a href="https://arxiv.org/abs/8495.19481">PushWorld paper</a> provides details of these puzzle sets, and the table below shows the percentage of training and testing puzzles solved by PPO and DQN. Overall, PPO outperforms DQN but shows signs of overfitting.</span>

  <table class="related-table results-table">
    <colgroup>
      <col span="1" style="width: 32%;">
      <col span="1" style="width: 17%;">
      <col span="1" style="width: 17%;">
      <col span="1" style="width: 17%;">
      <col span="1" style="width: 17%;">
    </colgroup>
    <tbody>
      <tr class="name-row">
        <td></td>
        <td colspan="2" class="left-border">PPO</td>
        <td colspan="2" class="left-border">DQN</td>
      </tr>
      <tr class="top-row">
        <td>Level 0 Puzzle Set</td>
        <td class="left-border">Train</td>
        <td>Test</td>
        <td class="left-border">Train</td>
        <td>Test</td>
      </tr>
      <tr>
        <td>Base</td>
        <td class="left-border">88.5%</td>
        <td>40.4%</td>
        <td class="left-border">24.9%</td>
        <td>19.5%</td>
      </tr>
      <tr>
        <td>Larger Puzzle Sizes</td>
        <td class="left-border">93.2%</td>
        <td>71.5%</td>
        <td class="left-border">61.2%</td>
        <td>61.8%</td>
      </tr>
      <tr>
        <td>More Walls</td>
        <td class="left-border">77.9%</td>
        <td>23.3%</td>
        <td class="left-border">18.5%</td>
        <td>13.1%</td>
      </tr>
      <tr>
        <td>More Obstacles</td>
        <td class="left-border">64.7%</td>
        <td>21.4%</td>
        <td class="left-border">17.6%</td>
        <td>13.1%</td>
      </tr>
      <tr>
        <td>More Shapes</td>
        <td class="left-border">74.5%</td>
        <td>24.2%</td>
        <td class="left-border">23.9%</td>
        <td>17.1%</td>
      </tr>
      <tr>
        <td>Multiple Goals</td>
        <td class="left-border">5.3%</td>
        <td>1.1%</td>
        <td class="left-border">0.9%</td>
        <td>0.2%</td>
      </tr>
      <tr>
        <td>All</td>
        <td class="left-border">21.2%</td>
        <td>5.7%</td>
        <td class="left-border">11.4%</td>
        <td>10.1%</td>
      </tr>
    </tbody>
  </table>
</div>

<div class="section">
  <div class="title">Next Steps</div>

  <span class="text">PushWorld presents a challenge for both classical planners and model-free RL algorithms. After playing the benchmark puzzles yourself, we hope you were able to solve >95% of the puzzles in far less than 30 minutes per puzzle, demonstrating that current artificial intelligence algorithms are not yet human-level in PushWorld. We hope you are inspired to develop new algorithms that are closer to human-level performance.</span>
</div>

<!-- <div class="section">
  <div class="title">Cite PushWorld</div>

  <div style="display: inline-block;">
    <div style="width: 60%; height: auto; float: left;">
      <pre style="overflow-x: auto; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; font-size: 14px;">
@article{pushworld2022,
  title={PushWorld: A benchmark for planning with physical tools and obstacles},
  author={Author1, author2, author2},
  journal={arXiv preprint arXiv:2022.10212},
  year={2022}
}
      </pre>
    </div>
    <img src="images/pushworld-paper.png" alt="PushWorld Sample Puzzles" width="100%" height="auto" style="-webkit-filter: drop-shadow(5px 5px 5px #666666); filter: drop-shadow(5px 5px 5px #666666); float: left; width: 40%; height: auto;"/>
  </div>
</div>
 -->
<div class="section">
  <div class="main-links">
    <a class="btn btn-large btn-default" href="https://arxiv.org/abs/8495.19481">
      <span class="icon icon-doc-text-inv icon-text"></span>
      Read Paper
    </a>
    <a class="btn btn-large btn-default" href="https://github.com/deepmind/pushworld">
      <span class="icon icon-github icon-text"></span>
      View Github
    </a>
    <a class="btn btn-large btn-default" style="margin-right: 0px;" href="mailto:pushworld@deepmind.com">
      <span class="icon icon-mail icon-text"></span>
      Contact Us
    </a>
  </div>
</div>

</div>

<div id="footer">
  <p style="text-align: center;"><strong>Copyright © 2022 DeepMind Technologies Ltd.</strong></p>
</div>

<!-- Javascript - place at the end to avoid blocking page loading -->
<script src="jquery-3.6.0.min.js" charset="utf-8"></script>
<script src="index.js" charset="utf-8"></script>

</body>
</html>
