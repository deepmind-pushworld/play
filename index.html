<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>PushWorld</title>

  <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />

  <!-- Stylesheets -->
  <link rel="stylesheet" href="photon.min.css">
  <link rel="stylesheet" href="index.css">
  <link rel="stylesheet" href="puzzle_player.css">

  <!-- Javascript -->
  <script src="jquery-3.6.0.min.js" charset="utf-8"></script>
  <script src="index.js" charset="utf-8"></script>
</head>

<body>
<div id="header">
  <div class="content">
    <div class="title">PushWorld: A benchmark for planning with physical tools and obstacles</div>
    <img class="banner" src="images/sample-puzzles.png" alt="Example PushWorld Puzzles"/>
  </div>
</div>

<div class="section">
  <div class="main-links">
    <a class="btn btn-large btn-default" href="https://arxiv.org/abs/8495.19481">
      <span class="icon icon-doc-text-inv icon-text"></span>
      Read Paper
    </a>
    <a class="btn btn-large btn-default" href="https://github.com/deepmind/pushworld">
      <span class="icon icon-github icon-text"></span>
      View Github
    </a>
    <a class="btn btn-large btn-default" style="margin-right: 0px;" href="mailto:pushworld@deepmind.com">
      <span class="icon icon-mail icon-text"></span>
      Contact Us
    </a>
  </div>
</div>

<div class="section">
  <span class="text">
  PushWorld is a novel grid-world environment designed to test planning and reasoning
  with physical tools and movable obstacles. While recent advances in artificial intelligence have achieved human-level performance in environments like Starcraft and Go, many physical reasoning tasks remain challenging for computers. The PushWorld benchmark contains a collection of puzzles that emphasize this challenge while minimizing the complexity of physics.</span>

  <span class="text">PushWorld is available as an OpenAI Gym environment and in PDDL format in <a href="https://www.deepmind.com/">Github</a>. The environment is suitable for research in classical planning, reinforcement learning, combined task and motion planning, and cognitive science.</span>
</div>

<div class="section">
  <div class="title">Play PushWorld</div>

  <div class="pushworld_puzzles">
    <div class="select_puzzle_group">
      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="title vcenter">Select a Puzzle Difficulty</div>
        </div>
      </div>
      <div style="height:520px; background-color: #f6f6f6; padding-top:125px;">
        <div style="text-align: center;">
          <div><div style="font-size:20px; padding:10px 20px;" class="btn btn-form btn-large btn-primary" puzzle_group="level1">Level 1</div></div>
          <div style="margin-top:20px;"><div style="font-size:20px; padding:10px 20px;" class="btn btn-form btn-large btn-primary" puzzle_group="level2">Level 2</div></div>
          <div style="margin-top:20px;"><div style="font-size:20px; padding:10px 20px;" class="btn btn-form btn-large btn-primary" puzzle_group="level3">Level 3</div></div>
          <div style="margin-top:20px;"><div style="font-size:20px; padding:10px 20px;" class="btn btn-form btn-large btn-primary" puzzle_group="level4">Level 4</div></div>
        </div>
      </div>
    </div>

    <div id="pw-preview-template" class="pushworld_preview">
      <canvas class="vcenter" height="130px" width="130px"></canvas>
    </div>

    <div class="preview_panel" puzzle_group="level1" style="display:none;">

      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="return_select_puzzle_group btn btn-large btn-default">
              <span class="icon icon-left icon-text"></span>
              Select Difficulty
            </button>
          </div>
          <div class="title puzzle_title vcenter">Level 1 Puzzles</div>
        </div>
      </div>

      <div class="preview_list">
        <div class="loading modal", style="display: block;">
          <div class="modal-content">
            Loading...
          </div>
        </div>
        <div class="previews">
        </div>
      </div>
    </div>

    <div class="preview_panel" puzzle_group="level2" style="display:none;">

      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="return_select_puzzle_group btn btn-large btn-default">
              <span class="icon icon-left icon-text"></span>
              Select Difficulty
            </button>
          </div>
          <div class="title puzzle_title vcenter">Level 2 Puzzles</div>
        </div>
      </div>

      <div class="preview_list">
        <div class="loading modal", style="display: block;">
          <div class="modal-content">
            Loading...
          </div>
        </div>
        <div class="previews">
        </div>
      </div>
    </div>

    <div class="preview_panel" puzzle_group="level3" style="display:none;">

      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="return_select_puzzle_group btn btn-large btn-default">
              <span class="icon icon-left icon-text"></span>
              Select Difficulty
            </button>
          </div>
          <div class="title puzzle_title vcenter">Level 3 Puzzles</div>
        </div>
      </div>

      <div class="preview_list">
        <div class="loading modal", style="display: block;">
          <div class="modal-content">
            Loading...
          </div>
        </div>
        <div class="previews">
        </div>
      </div>
    </div>

    <div class="preview_panel" puzzle_group="level4" style="display:none;">

      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="return_select_puzzle_group btn btn-large btn-default">
              <span class="icon icon-left icon-text"></span>
              Select Difficulty
            </button>
          </div>
          <div class="title puzzle_title vcenter">Level 4 Puzzles</div>
        </div>
      </div>

      <div class="preview_list">
        <div class="loading modal", style="display: block;">
          <div class="modal-content">
            Loading...
          </div>
        </div>
        <div class="previews">
        </div>
      </div>
    </div>

    <div class="puzzle_panel">
      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="all_puzzles btn btn-large btn-default">
              <span class="icon icon-layout icon-text"></span>
              Puzzle List
            </button>
          </div>
          <div class="title puzzle_title vcenter">Puzzle name</div>
          <div class="right-buttons">
            <button class="reset_button btn btn-large btn-default pull-right">
              <span class="icon icon-to-start icon-text"></span>
              Reset
            </button>

            <button class="undo_button btn btn-large btn-default pull-right">
              <span class="icon icon-left icon-text"></span>
              Undo
            </button>
          </div>
        </div>
      </div>

      <div class="puzzle">
        <div id="instructions_modal" class="modal" style="display:block;">
          <div class="modal-content">
            <div class="arrow-keys">
              <div class="key hidden"></div>
              <div class="key"><span class="icon icon-up-bold"></span></div>
              <div class="key hidden"></div>
              <div class="key"><span class="icon icon-left-bold"></span></div>
              <div class="key"><span class="icon icon-down-bold"></span></div>
              <div class="key"><span class="icon icon-right-bold"></span></div>
            </div>
            <div class="text">Use the arrow keys to push the <a>red shapes</a> into their outlines. Use the
              <span class="icon icon-left icon-text" style="margin: 0px 5px;"></span><b>Undo</b>
            and
            <span class="icon icon-to-start icon-text" style="margin: 0px 5px;"></span><b>Reset</b>
            buttons above to retry a puzzle.
            </div>
            <button type="submit" class="btn btn-form btn-large btn-primary">OK, got it!</button>
          </div>
        </div>

        <div id="solved_modal" class="modal">
          <div class="modal-content">
            Solved!
          </div>
        </div>

        <canvas id="play_canvas" height="500px" width="628px"></canvas>
      </div>
    </div>
  </div>
</div>

<div class="section">
  <div class="title">PushWorld vs. Related Environments</div>

  <span class="text">Solving PushWorld puzzles requires many skills, including:</span>

  <ul>
    <li>
      <b>Path Planning</b>: Finding a collision-free path to move an object from one position to another, considering walls and object shapes.
    </li>
    <li>
      <b>Manipulation Planning</b>: Exploring alternative ways to push an object along a desired path. Some puzzles require the agent to preemptively position itself so that it can move from pushing in one direction to pushing in a different direction in the future.
    </li>
    <li>
      <b>Moving Obstacles</b>: The agent must decide between finding a path around an obstacle or moving the obstacle out of the way. Some obstacles introduce choices in which freeing one path blocks another, and choices can be irreversible. Obstacles can also be "parasitic": once pushed against an object, the agent can never separate the obstacle from the object.
    </li>
    <li>
      <b>Using Tools</b>: Sometimes to move an object into a desired position, the agent must use one or more objects as tools to indirectly push the target object: the agent pushes a tool object, which simultaneously pushes the target or another tool. In some puzzles the agent must assemble a tool by pushing multiple objects together.
    </li>
    <li>
      <b>Prioritizing Multiple Goals</b>: Sometimes moving an object into its goal position may prevent achieving another goal. Puzzles may also require achieving multiple goals simultaneously by preemptively arranging objects and pushing them all at once.
    </li>
  </ul>

  <span class="text">Several existing environments have comparable physical dynamics: <a href="https://en.wikipedia.org/wiki/Sokoban">Sokoban</a>, <a href="https://en.wikipedia.org/wiki/Sliding_puzzle">sliding block puzzles</a>, and grid-based path planning. However, none of these environments require all of the skills above.</span>

  <img src="images/pushworld-related.png" alt="PushWorld Sample Puzzles" width="100%" height="auto"/>
</div>

<div class="section">
  <div class="title">Evaluation: Classical Planners</div>
  <b>Methods</b>
  <ul>
    <li><span><em>Fast Forward</em> is a seminal planning algorithm relying on a delete relaxation heuristic for efficient computation at a loss of accuracy.</span></li>

    <li><span><em>Fast  Downward</em>  precomputes  domain  transition graphs to efficiently estimate the cost of transitioning avariable to a desired value.</span></li>

    <li><span><em>LAMA</em> uses propositional  formulas  that  must  be satisfied as landmarks during planning (winner of IPC2008 sequential satisficing track).</span></li>

    <li><span><em>Fast Downward Stone Soup (FDSS)</em> is a portfolio of planners (winner of IPC 2018 satisficing track).</span></li>

    <li><span><em>Best-First Width Search (BFWS)</em> uses a heuristic that prioritizes exploring states with novel combinationsof variable values ( winner of IPC 2018 agile track).</span></li>

    <li><span><em>Saarplan</em> is another portfolio of planners (runner-upof IPC 2018 agile).</span></li>

    <li><span><em>RGD</em> uses our proposed recursive graph distance heuristic.</span></li>

    <li><span><em>RGD+Novelty</em> uses our proposed RGD heuristic combined with the Novelty heuristic as in BFWS.</span></li>
  </ul>


  <b>Results</b>
  <ul>
    <li><span>RGD+Novelty solves the most 73.5% puzzles, followed by FDSS.</span></li>
    <li><span>Novelty+RGD solves more puzzles in 50 seconds than FDSS doesin 30 minutes.</li>
  </ul>

  <img src="images/pushworld-evaluation-planner.png" alt="Classical Planning Results" width="100%" height="auto"/>

  <div style="display: inline-block;">
      <img src="images/pushworld-planner-demo-po.gif" alt="PushWorld Sample Puzzles" width="auto" height="250px" align="left"/>
      <img src="images/pushworld-planner-demo-mwo.gif" alt="PushWorld Sample Puzzles" width="auto" height="250px" align="right" style="margin-left: 20px;"/>
    </div>
  </div>
</div>

<div class="section">
  <div class="title">Evaluation: Model-Free Deep RL</div>
  <b>Methods</b>
  <ul>
    <li><span><em>Deep Q-Networks (DQN)</em> is an off-policy, value-based algorithm that has shown great success in Atari games and other domains.</span></li>
    <li><span><em>Proximal Policy Optimization (PPO)</em> is an on-policy policy gradient algorithm that has been shown to be powerful and robust for a wide range of tasks.</span></li>
  </ul>

  <b>Results</b>
  <ul>
    <li><span>Neither DQN nor PPO managed to obtain any meaningful results on Level 1 after augmentation due to the nature of extreme sparse reward in PushWorld.</span></li>
    <li><span>A simplified Level 0 puzzle set and variations were created to mitigate sparse reward by keeping the puzzle size small.</span></li>
    <li><span>PPO outperformed DQN but showing some signs of overfitting.</span></li>
  </ul>

  <img src="images/pushworld-evaluation-rl.png" alt="Model-Free Deep RL Results" width="100%" height="auto"/>

<!--   <div style="display: inline-block;">
      <img src="images/pushworld-planner-demo-po.gif" alt="PushWorld Sample Puzzles" width="auto" height="250px" align="left"/>
      <img src="images/pushworld-planner-demo-mwo.gif" alt="PushWorld Sample Puzzles" width="auto" height="250px" align="right" style="margin-left: 20px;"/>
    </div>
  </div> -->
</div>

<!-- <div class="section">
  <div class="title">Cite PushWorld</div>

  <div style="display: inline-block;">
    <div style="width: 60%; height: auto; float: left;">
      <pre style="overflow-x: auto; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; font-size: 14px;">
@article{pushworld2022,
  title={PushWorld: A benchmark for planning with physical tools and obstacles},
  author={Author1, author2, author2},
  journal={arXiv preprint arXiv:2022.10212},
  year={2022}
}
      </pre>
    </div>
    <img src="images/pushworld-paper.png" alt="PushWorld Sample Puzzles" width="100%" height="auto" style="-webkit-filter: drop-shadow(5px 5px 5px #666666); filter: drop-shadow(5px 5px 5px #666666); float: left; width: 40%; height: auto;"/>
  </div>
</div>
 -->
<div class="section">
  <div class="main-links">
    <a class="btn btn-large btn-default" href="https://arxiv.org/abs/8495.19481">
      <span class="icon icon-doc-text-inv icon-text"></span>
      Read Paper
    </a>
    <a class="btn btn-large btn-default" href="https://github.com/deepmind/pushworld">
      <span class="icon icon-github icon-text"></span>
      View Github
    </a>
    <a class="btn btn-large btn-default" style="margin-right: 0px;" href="mailto:pushworld@deepmind.com">
      <span class="icon icon-mail icon-text"></span>
      Contact Us
    </a>
  </div>
</div>

<div id="footer">
  <p style="text-align: center;"><strong>Copyright © 2022 DeepMind Technologies Ltd.</strong></p>
</div>

</body>
</html>
