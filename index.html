<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>PushWorld</title>

  <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />

  <!-- Stylesheets -->
  <link rel="stylesheet" href="photon.min.css">
  <link rel="stylesheet" href="index.css">
  <link rel="stylesheet" href="puzzle_player.css">

  <!-- Javascript -->
  <script src="jquery-3.6.0.min.js" charset="utf-8"></script>
  <script src="index.js" charset="utf-8"></script>
</head>

<body>
<div id="header">
  <div class="content">
    <div class="title">PushWorld: A benchmark for planning with physical tools and obstacles</div>
    <img class="banner" src="images/sample-puzzles.png" alt="Example PushWorld Puzzles"/>
  </div>
</div>

<div class="section">
  <div class="main-links">
    <a class="btn btn-large btn-default" href="https://arxiv.org/abs/8495.19481">
      <span class="icon icon-doc-text-inv icon-text"></span>
      Read Paper
    </a>
    <a class="btn btn-large btn-default" href="https://arxiv.org/abs/8495.19481">
      <span class="icon icon-github icon-text"></span>
      View Github
    </a>
    <a class="btn btn-large btn-default" style="margin-right: 0px;" href="mailto:pushworld@deepmind.com">
      <span class="icon icon-mail icon-text"></span>
      Contact Us
    </a>
  </div>
</div>

<div class="section">
  <span class="text">
  PushWorld is a novel grid-world environment designed to test planning and reasoning
  with physical tools and movable obstacles. While recent advances in artificial intelligence have achieved human-level performance in environments like Starcraft and Go, many physical reasoning tasks remain challenging for computers. The PushWorld benchmark contains a collection of puzzles that emphasize this challenge while minimizing the complexity of physics.</span>

  <span class="text">PushWorld is available as an OpenAI Gym environment and in PDDL format in <a href="https://www.deepmind.com/">Github</a>. The environment is suitable for research in classical planning, reinforcement learning, combined task and motion planning, and cognitive science.</span>
</div>

<div class="section">
  <div class="title">Play PushWorld</div>

  <div class="pushworld_puzzles">
    <div class="select_puzzle_group">
      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="title vcenter">Select a Puzzle Difficulty</div>
        </div>
      </div>
      <div style="height:520px; background-color: #f6f6f6; padding-top:125px;">
        <div style="text-align: center;">
          <div><div style="font-size:20px; padding:10px 20px;" class="btn btn-form btn-large btn-primary" puzzle_group="level1">Level 1</div></div>
          <div style="margin-top:20px;"><div style="font-size:20px; padding:10px 20px;" class="btn btn-form btn-large btn-primary" puzzle_group="level2">Level 2</div></div>
          <div style="margin-top:20px;"><div style="font-size:20px; padding:10px 20px;" class="btn btn-form btn-large btn-primary" puzzle_group="level3">Level 3</div></div>
          <div style="margin-top:20px;"><div style="font-size:20px; padding:10px 20px;" class="btn btn-form btn-large btn-primary" puzzle_group="level4">Level 4</div></div>
        </div>
      </div>
    </div>

    <div class="preview_panel" puzzle_group="level1" style="display:none;">

      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="return_select_puzzle_group btn btn-large btn-default">
              <span class="icon icon-left icon-text"></span>
              Select Difficulty
            </button>
          </div>
          <div class="title puzzle_title vcenter">Level 1 Puzzles</div>
        </div>
      </div>

      <div class="previews">
        <div id="pw-preview-template" class="pushworld_preview">
          <canvas class="vcenter" height="130px" width="130px"></canvas>
        </div>
      </div>
    </div>

    <div class="preview_panel" puzzle_group="level2" style="display:none;">

      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="return_select_puzzle_group btn btn-large btn-default">
              <span class="icon icon-left icon-text"></span>
              Select Difficulty
            </button>
          </div>
          <div class="title puzzle_title vcenter">Level 2 Puzzles</div>
        </div>
      </div>

      <div class="previews">
        <div id="pw-preview-template" class="pushworld_preview">
          <canvas class="vcenter" height="130px" width="130px"></canvas>
        </div>
      </div>
    </div>

    <div class="preview_panel" puzzle_group="level3" style="display:none;">

      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="return_select_puzzle_group btn btn-large btn-default">
              <span class="icon icon-left icon-text"></span>
              Select Difficulty
            </button>
          </div>
          <div class="title puzzle_title vcenter">Level 3 Puzzles</div>
        </div>
      </div>

      <div class="previews">
        <div id="pw-preview-template" class="pushworld_preview">
          <canvas class="vcenter" height="130px" width="130px"></canvas>
        </div>
      </div>
    </div>

    <div class="preview_panel" puzzle_group="level4" style="display:none;">

      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="return_select_puzzle_group btn btn-large btn-default">
              <span class="icon icon-left icon-text"></span>
              Select Difficulty
            </button>
          </div>
          <div class="title puzzle_title vcenter">Level 4 Puzzles</div>
        </div>
      </div>

      <div class="previews">
        <div id="pw-preview-template">
          <canvas class="vcenter" height="130px" width="130px"></canvas>
        </div>
      </div>
    </div>

    <div class="puzzle_panel">
      <div class="toolbar toolbar-header">
        <div class="toolbar-actions">
          <div class="left-buttons">
            <button class="all_puzzles btn btn-large btn-default">
              <span class="icon icon-layout icon-text"></span>
              Puzzle List
            </button>
          </div>
          <div class="title puzzle_title vcenter">Puzzle name</div>
          <div class="right-buttons">
            <button class="reset_button btn btn-large btn-default pull-right">
              <span class="icon icon-to-start icon-text"></span>
              Reset
            </button>

            <button class="undo_button btn btn-large btn-default pull-right">
              <span class="icon icon-left icon-text"></span>
              Undo
            </button>
          </div>
        </div>
      </div>

      <div class="puzzle">
        <div id="instructions_modal" class="modal" style="display:block;">
          <div class="modal-content">
            <div class="arrow-keys">
              <div class="key hidden"></div>
              <div class="key"><span class="icon icon-up-bold"></span></div>
              <div class="key hidden"></div>
              <div class="key"><span class="icon icon-left-bold"></span></div>
              <div class="key"><span class="icon icon-down-bold"></span></div>
              <div class="key"><span class="icon icon-right-bold"></span></div>
            </div>
            <div class="text">Use the arrow keys to push the <a>red shapes</a> into their outlines. Use the
              <span class="icon icon-left icon-text" style="margin: 0px 5px;"></span><b>Undo</b>
            and
            <span class="icon icon-to-start icon-text" style="margin: 0px 5px;"></span><b>Reset</b>
            buttons above to retry a puzzle.
            </div>
            <button type="submit" class="btn btn-form btn-large btn-primary">OK, got it!</button>
          </div>
        </div>

        <div id="solved_modal" class="modal">
          <div class="modal-content">
            Solved!
          </div>
        </div>

        <canvas id="play_canvas" height="500px" width="628px"></canvas>
      </div>
    </div>
  </div>
</div>

<div class="section">
  <div class="title">PushWorld vs. Related Environments</div>

  <span class="text">Solving PushWorld puzzles requires many skills, including:</span>

  <ul>
    <li>
      <b>Path Planning</b>: Finding a collision-free path to move an object from one position to another, considering walls and object shapes.
    </li>
    <li>
      <b>Manipulation Planning</b>: Exploring alternative ways to push an object along a desired path. Some puzzles require the agent to preemptively position itself so that it can move from pushing in one direction to pushing in a different direction in the future.
    </li>
    <li>
      <b>Moving Obstacles</b>: The agent must decide between finding a path around an obstacle or moving the obstacle out of the way. Some obstacles introduce choices in which freeing one path blocks another, and choices can be irreversible. Obstacles can also be "parasitic": once pushed against an object, the agent can never separate the obstacle from the object.
    </li>
    <li>
      <b>Using Tools</b>: Sometimes to move an object into a desired position, the agent must use one or more objects as tools to indirectly push the target object: the agent pushes a tool object, which simultaneously pushes the target or another tool. In some puzzles the agent must assemble a tool by pushing multiple objects together.
    </li>
    <li>
      <b>Prioritizing Multiple Goals</b>: Sometimes moving an object into its goal position may prevent achieving another goal. Puzzles may also require achieving multiple goals simultaneously by preemptively arranging objects and pushing them all at once.
    </li>
  </ul>

  <span class="text">Several existing environments have comparable physical dynamics: <a href="https://en.wikipedia.org/wiki/Sokoban">Sokoban</a>, <a href="https://en.wikipedia.org/wiki/Sliding_puzzle">sliding block puzzles</a>, and grid-based path planning. However, none of these environments require all of the skills above.</span>

  <img src="images/pushworld-related.png" alt="PushWorld Sample Puzzles" width="100%" height="auto"/>
</div>

<div class="section">
  <div class="title">Evaluation: Classical Planners</div>
  <ul>
    <li><span>Fast Forward is an early seminal planning algorithm. Its search heuristic relies on a delete relaxation for efficient computation, but this relaxation also reduces the accuracy of the heuristic.</span></li>

    <li><span>Fast Downward introduced the concept of domain transition graphs, which are precomputed to efficiently estimate the cost of transitioning a variable to a desired value, like moving an object into a target position.</span></li>

    <li><span>LAMA won the sequential satisficing track of the International Planning Competition (IPC) 2008 and introduced the concept of landmarks, which are propositional formulas that must be satisfied at some time in all solutions of a planning task.</span></li>

    <li><span>Fast Downward Stone Soup won the satisficing track of IPC 2018 using a portfolio of multiple planners.</span></li>

    <li><span>Best-First Width Search won the agile track of IPC 2018 by introducing a heuristic that prioritizes exploring states with novel combinations of variable values.</span></li>

    <li><span>Saarplan was the runner-up in the agile track of IPC 2018, and like FDSS, it uses a portfolio of multiple planners.</span></li>
  </ul>

  <img src="images/pushworld-evaluation-planner.png" alt="Classical Planning Results" width="100%" height="auto"/>

  <div style="display: inline-block;">
      <img src="images/pushworld-planner-demo-po.gif" alt="PushWorld Sample Puzzles" width="auto" height="250px" align="left"/>
      <img src="images/pushworld-planner-demo-mwo.gif" alt="PushWorld Sample Puzzles" width="auto" height="250px" align="right" style="margin-left: 20px;"/>
    </div>
  </div>
</div>

<div class="section">
  <div class="title">Evaluation: Deep Reinforcement Learning</div>
  <ul>
    <li><span>DQN Well-known,representative    q-learning(value-based),  open source,  among most popular DRLframeworks. XL: Scott TODO: re-write formally</span></li>
    <li><span>PPO[21] Well-known, representative policy optimiza-tion,  open  source,  among  most  popular  DRL  frame-works. XL: Scott TODO: re-write formally.</span></li>
  </ul>

  <img src="images/pushworld-evaluation-planner.png" alt="Classical Planning Results" width="100%" height="auto"/>

  <div style="display: inline-block;">
      <img src="images/pushworld-planner-demo-po.gif" alt="PushWorld Sample Puzzles" width="auto" height="250px" align="left"/>
      <img src="images/pushworld-planner-demo-mwo.gif" alt="PushWorld Sample Puzzles" width="auto" height="250px" align="right" style="margin-left: 20px;"/>
    </div>
  </div>
</div>

<div class="section">
  <div class="title">Cite PushWorld</div>

  <div style="display: inline-block;">
    <div style="width: 60%; height: auto; float: left;">
      <pre style="overflow-x: auto; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; font-size: 14px;">
@article{pushworld2022,
  title={PushWorld: A benchmark for planning with physical tools and obstacles},
  author={Author1, author2, author2},
  journal={arXiv preprint arXiv:2022.10212},
  year={2022}
}
      </pre>
    </div>
    <img src="images/pushworld-paper.png" alt="PushWorld Sample Puzzles" width="100%" height="auto" style="-webkit-filter: drop-shadow(5px 5px 5px #666666); filter: drop-shadow(5px 5px 5px #666666); float: left; width: 40%; height: auto;"/>
  </div>
</div>

<div class="section">
  <div class="main-links">
    <a class="btn btn-large btn-default" href="https://arxiv.org/abs/8495.19481">
      <span class="icon icon-doc-text-inv icon-text"></span>
      Read Paper
    </a>
    <a class="btn btn-large btn-default" href="https://arxiv.org/abs/8495.19481">
      <span class="icon icon-github icon-text"></span>
      View Github
    </a>
    <a class="btn btn-large btn-default" style="margin-right: 0px;" href="mailto:pushworld@deepmind.com">
      <span class="icon icon-mail icon-text"></span>
      Contact Us
    </a>
  </div>
</div>

<div id="footer">
  <p style="text-align: center;"><strong>Copyright © 2022 DeepMind Technologies Ltd.</strong></p>
</div>

</body>
</html>
